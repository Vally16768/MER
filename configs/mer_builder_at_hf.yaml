dataset:
  name: MER_BUILDER_AT_HF
  num_classes: 7
  class_names:
    - anger
    - disgust
    - fear
    - joy
    - neutral
    - sadness
    - surprise

modalities: [A, T]

data:
  train_dir: data/features/mer_builder_at_hf/train
  val_dir: data/features/mer_builder_at_hf/val
  eval_dir: data/features/mer_builder_at_hf/testB
  extensions: [".pkl", ".pickle"]
  num_workers: 4
  loader:
    persistent_workers: true
    prefetch_factor: 4

model:
  type: robust_at
  input_dim_a: 768
  input_dim_t: 768
  hidden_dim: 256
  num_layers: 4
  num_heads: 8
  ffn_mult: 4
  dropout: 0.0

training:
  device: auto
  seed: 42
  batch_size: 64
  epochs: 60
  learning_rate: 3.0e-4
  weight_decay: 1.0e-4
  optimizer: adamw
  class_weights: balanced
  label_smoothing: 0.1
  grad_clip_norm: 1.0
  scheduler:
    type: reduceonplateau
    metric: uar
    mode: max
    factor: 0.5
    patience: 2
    min_lr: 1.0e-6
  patience: 10
  min_delta: 1.0e-4
  sampling:
    type: weighted
    # Upweight MELD to improve TestB (conversational out-of-domain).
    dataset_weights:
      MELD: 5.0
  best_metric: UAR

output:
  root_dir: outputs
